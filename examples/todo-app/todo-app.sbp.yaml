sbp: "0.3.0"

meta:
  name: „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÁÆ°ÁêÜToDo
  description: „Éó„É≠„Ç∏„Çß„ÇØ„Éà„Åî„Å®„Å´„Çø„Çπ„ÇØ„Å®„Çø„Ç∞„ÇíÁÆ°ÁêÜ„Åß„Åç„ÇãToDo„Ç¢„Éó„É™
  version: "4.0.0"

types:
  Project:
    id: string
    name: string
    createdAt: datetime

  TagCategory:
    id: string
    name: string
    icon: string

  Tag:
    id: string
    categoryId: string
    name: string

  Todo:
    id: string
    text: string
    description: string?
    completed: boolean
    tagIds: string[]
    createdAt: datetime
    updatedAt: datetime

  TodoForm:
    text: string
    description: string

globals:
  projects:
    type: Project[]
    initial: []
    persist: true

  currentProjectId:
    type: string?
    initial: null
    persist: true

  tagCategories:
    type: TagCategory[]
    initial:
      - id: "label"
        name: „É©„Éô„É´
        icon: "üè∑Ô∏è"
      - id: "assignee"
        name: ÊãÖÂΩìËÄÖ
        icon: "üë§"
      - id: "priority"
        name: ÂÑ™ÂÖàÂ∫¶
        icon: "üî¥"

  tags:
    type: Tag[]
    initial: []
    persist: true

  todos:
    type: Todo[]
    initial: []
    persist: true

screens:
  Dashboard:
    title: „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ
    description: ÈÅ∏Êäû‰∏≠„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆÁµ±Ë®à„Å®ÊúÄËøë„ÅÆ„Çø„Çπ„ÇØ„ÇíË°®Á§∫

    route: /

    computed:
      currentProject:
        find: projects
        where: id equals currentProjectId

      projectTodos:
        filter: todos
        where: projectId equals currentProjectId

      incompleteTodos:
        filter: projectTodos
        where: not completed

      completedTodos:
        filter: projectTodos
        where: completed

      incompleteCount:
        count: incompleteTodos

      completedCount:
        count: completedTodos

      recentTodos:
        take: projectTodos
        limit: 5
        sortBy: updatedAt desc

    layout:
      - AppLayout:
          children:
            - Card:
                padding: tokens.spacing.lg
                children:
                  - Text:
                      variant: h1
                      content: currentProject.name
                      align: center

                  - Spacer:
                      height: tokens.spacing.lg

                  - Stack:
                      direction: horizontal
                      gap: tokens.spacing.md
                      justify: center
                      children:
                        - StatCard:
                            label: Êú™ÂÆå‰∫Ü
                            value: incompleteCount

                        - StatCard:
                            label: ÂÆå‰∫Ü
                            value: completedCount

                  - Divider:
                      margin: tokens.spacing.lg

                  - Text:
                      variant: h3
                      content: ÊúÄËøë„ÅÆ„Çø„Çπ„ÇØ

                  - Spacer:
                      height: tokens.spacing.sm

                  - each: recentTodos
                    as: todo
                    key: todo.id
                    render:
                      - TodoItem:
                          todo: todo
                          on:click: navigate(TodoDetail, { id: todo.id })

                  - Spacer:
                      height: tokens.spacing.md

                  - Button:
                      label: „Åô„Åπ„Å¶„ÅÆ„Çø„Çπ„ÇØ„ÇíË¶ã„Çã ‚Üí
                      variant: text
                      fullWidth: true
                      on:click: navigate(TodoList)

  TodoList:
    title: „Çø„Çπ„ÇØ‰∏ÄË¶ß
    description: „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÂÜÖ„ÅÆ„Çø„Çπ„ÇØ‰∏ÄË¶ß„ÇíË°®Á§∫„Åó„ÄÅËøΩÂä†„ÉªÂÆå‰∫Ü„ÉªÂâäÈô§„Åå„Åß„Åç„Çã

    route: /todos

    state:
      newTodoText:
        type: string
        initial: ""

      filterStatus:
        type: enum[all, incomplete, completed]
        initial: all

      filterLabel:
        type: string?
        initial: null

      filterAssignee:
        type: string?
        initial: null

    computed:
      projectTodos:
        filter: todos
        where: projectId equals currentProjectId

      filteredTodos:
        filter: projectTodos
        where:
          all:
            - when: filterStatus equals "incomplete"
              then: not completed
            - when: filterStatus equals "completed"
              then: completed
            - when: filterLabel is not null
              then: tagIds contains filterLabel
            - when: filterAssignee is not null
              then: tagIds contains filterAssignee

      remainingCount:
        count: projectTodos
        where: not completed

      hasCompleted:
        any: projectTodos
        where: completed

      isEmpty:
        count: filteredTodos
        equals: 0

      labelTags:
        filter: tags
        where: categoryId equals "label"

      assigneeTags:
        filter: tags
        where: categoryId equals "assignee"

    layout:
      - AppLayout:
          children:
            - Card:
                padding: tokens.spacing.lg
                children:
                  - Text:
                      variant: h1
                      content: „Çø„Çπ„ÇØ‰∏ÄË¶ß
                      align: center

                  - Stack:
                      direction: horizontal
                      gap: tokens.spacing.sm
                      children:
                        - TextField:
                            value: newTodoText
                            placeholder: Êñ∞„Åó„ÅÑ„Çø„Çπ„ÇØ„ÇíÂÖ•Âäõ...
                            flex: 1
                            on:change:
                              set: { newTodoText: value }
                            on:keydown:
                              - when: event.key is Enter and newTodoText is not empty
                                do: actions.addTodo

                        - Button:
                            label: ËøΩÂä†
                            variant: primary
                            disabled: newTodoText is empty
                            on:click: actions.addTodo

                  - Spacer:
                      height: tokens.spacing.md

                  - Stack:
                      direction: horizontal
                      gap: tokens.spacing.sm
                      children:
                        - Select:
                            label: Áä∂ÊÖã
                            value: filterStatus
                            options:
                              - value: all
                                label: „Åô„Åπ„Å¶
                              - value: incomplete
                                label: Êú™ÂÆå‰∫Ü
                              - value: completed
                                label: ÂÆå‰∫Ü
                            on:change:
                              set: { filterStatus: value }

                        - Select:
                            label: „É©„Éô„É´
                            value: filterLabel
                            options:
                              - value: null
                                label: „Åô„Åπ„Å¶
                              - each: labelTags
                                as: tag
                                value: tag.id
                                label: tag.name
                            on:change:
                              set: { filterLabel: value }

                        - Select:
                            label: ÊãÖÂΩì
                            value: filterAssignee
                            options:
                              - value: null
                                label: „Åô„Åπ„Å¶
                              - each: assigneeTags
                                as: tag
                                value: tag.id
                                label: tag.name
                            on:change:
                              set: { filterAssignee: value }

                  - Spacer:
                      height: tokens.spacing.md

                  - match: isEmpty
                    cases:
                      true:
                        - Text:
                            content: „Çø„Çπ„ÇØ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì
                            color: tokens.colors.text.secondary
                            align: center

                      false:
                        - Stack:
                            direction: vertical
                            gap: tokens.spacing.xs
                            children:
                              - each: filteredTodos
                                as: todo
                                key: todo.id
                                render:
                                  - TodoItemWithTags:
                                      todo: todo
                                      tags: tags
                                      on:toggle:
                                        bubble: false
                                        action: actions.toggleTodo(todo.id)
                                      on:click: navigate(TodoDetail, { id: todo.id })
                                      on:delete:
                                        bubble: false
                                        action: actions.deleteTodo(todo.id)

                  - Spacer:
                      height: tokens.spacing.md

                  - Stack:
                      direction: horizontal
                      justify: space-between
                      align: center
                      children:
                        - Text:
                            content: "ÊÆã„Çä {remainingCount} ‰ª∂"
                            variant: caption
                            color: tokens.colors.text.secondary

                        - when: hasCompleted
                          show:
                            - Button:
                                label: ÂÆå‰∫ÜÊ∏à„Åø„ÇíÂâäÈô§
                                variant: text
                                size: small
                                on:click: actions.clearCompleted

    actions:
      addTodo:
        steps:
          - create: todos
            values:
              id: uuid()
              projectId: currentProjectId
              text: trim(newTodoText)
              description: ""
              completed: false
              tagIds: []
              createdAt: now
              updatedAt: now
            position: beginning

          - set: { newTodoText: "" }

      toggleTodo:
        params:
          id: string
        steps:
          - update: todos
            find: id equals {id}
            set:
              completed: toggle
              updatedAt: now

      deleteTodo:
        params:
          id: string
        steps:
          - delete: todos
            where: id equals {id}

      clearCompleted:
        steps:
          - delete: todos
            where:
              all:
                - projectId equals currentProjectId
                - completed

  TodoDetail:
    title: „Çø„Çπ„ÇØË©≥Á¥∞
    description: „Çø„Çπ„ÇØ„ÅÆË©≥Á¥∞„ÇíË°®Á§∫„Åó„ÄÅ„Çø„Ç∞„ÅÆËøΩÂä†„ÉªÁ∑®ÈõÜ„Åå„Åß„Åç„Çã

    route: /todos/:id

    params:
      id:
        type: string
        required: true

    state:
      form:
        type: form
        schema: TodoForm
        initialFrom: todo
        fields: [text, description]

      isEditing:
        type: boolean
        initial: false

    computed:
      todo:
        find: todos
        where: id equals params.id

      notFound:
        check: todo is null

      todoTags:
        filter: tags
        where: id in todo.tagIds

      labelTags:
        filter: todoTags
        where: categoryId equals "label"

      assigneeTags:
        filter: todoTags
        where: categoryId equals "assignee"

      priorityTags:
        filter: todoTags
        where: categoryId equals "priority"

      availableLabelTags:
        filter: tags
        where:
          all:
            - categoryId equals "label"
            - id not in todo.tagIds

      availableAssigneeTags:
        filter: tags
        where:
          all:
            - categoryId equals "assignee"
            - id not in todo.tagIds

      availablePriorityTags:
        filter: tags
        where:
          all:
            - categoryId equals "priority"
            - id not in todo.tagIds

    layout:
      - AppLayout:
          children:
            - Card:
                padding: tokens.spacing.lg
                children:
                  - Stack:
                      direction: horizontal
                      justify: space-between
                      align: center
                      children:
                        - IconButton:
                            icon: arrow_back
                            on:click: navigate(TodoList)

                        - Text:
                            variant: h2
                            content: „Çø„Çπ„ÇØË©≥Á¥∞

                        - Box:
                            width: 40px

                  - Divider

                  - Spacer:
                      height: tokens.spacing.md

                  - when: notFound
                    show:
                      - Text:
                          content: „Çø„Çπ„ÇØ„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì
                          color: tokens.colors.error
                          align: center

                      - Button:
                          label: ‰∏ÄË¶ß„Å´Êàª„Çã
                          variant: outlined
                          fullWidth: true
                          on:click: navigate(TodoList)

                  - when: not notFound
                    show:
                      - match: isEditing
                        cases:
                          false:
                            - Stack:
                                direction: vertical
                                gap: tokens.spacing.md
                                children:
                                  - Stack:
                                      direction: horizontal
                                      align: center
                                      gap: tokens.spacing.sm
                                      children:
                                        - Checkbox:
                                            checked: todo.completed
                                            on:change: actions.toggleComplete

                                        - Text:
                                            variant: h3
                                            content: todo.text
                                            disabled: todo.completed

                                  - when: todo.description is not empty
                                    show:
                                      - Text:
                                          content: todo.description
                                          color: tokens.colors.text.secondary

                                  - Divider

                                  - TagSection:
                                      label: „É©„Éô„É´
                                      tags: labelTags
                                      availableTags: availableLabelTags
                                      on:add: actions.addTag
                                      on:remove: actions.removeTag

                                  - TagSection:
                                      label: ÊãÖÂΩìËÄÖ
                                      tags: assigneeTags
                                      availableTags: availableAssigneeTags
                                      on:add: actions.addTag
                                      on:remove: actions.removeTag

                                  - TagSection:
                                      label: ÂÑ™ÂÖàÂ∫¶
                                      tags: priorityTags
                                      availableTags: availablePriorityTags
                                      on:add: actions.addTag
                                      on:remove: actions.removeTag

                                  - Divider

                                  - Text:
                                      content: "‰ΩúÊàê: {formatDateTime(todo.createdAt, 'YYYY/MM/DD HH:mm')}"
                                      variant: caption
                                      color: tokens.colors.text.secondary

                                  - Text:
                                      content: "Êõ¥Êñ∞: {formatDateTime(todo.updatedAt, 'YYYY/MM/DD HH:mm')}"
                                      variant: caption
                                      color: tokens.colors.text.secondary

                                  - Spacer:
                                      height: tokens.spacing.md

                                  - Stack:
                                      direction: horizontal
                                      gap: tokens.spacing.sm
                                      children:
                                        - Button:
                                            label: Á∑®ÈõÜ
                                            variant: primary
                                            flex: 1
                                            on:click: actions.startEdit

                                        - Button:
                                            label: ÂâäÈô§
                                            variant: outlined
                                            color: error
                                            on:click: actions.delete

                          true:
                            - Stack:
                                direction: vertical
                                gap: tokens.spacing.md
                                children:
                                  - TextField:
                                      label: „Çø„Ç§„Éà„É´
                                      value: form.values.text
                                      error: form.errors.text
                                      on:change:
                                        set: { form.values.text: value }

                                  - TextField:
                                      label: Ë©≥Á¥∞Ôºà‰ªªÊÑèÔºâ
                                      value: form.values.description
                                      multiline: true
                                      rows: 3
                                      on:change:
                                        set: { form.values.description: value }

                                  - Stack:
                                      direction: horizontal
                                      gap: tokens.spacing.sm
                                      children:
                                        - Button:
                                            label: ‰øùÂ≠ò
                                            variant: primary
                                            flex: 1
                                            disabled: form.values.text is empty
                                            on:click: actions.save

                                        - Button:
                                            label: „Ç≠„É£„É≥„Çª„É´
                                            variant: outlined
                                            on:click: actions.cancelEdit

    actions:
      toggleComplete:
        steps:
          - update: todos
            find: id equals params.id
            set:
              completed: toggle
              updatedAt: now

      addTag:
        params:
          tagId: string
        steps:
          - update: todos
            find: id equals params.id
            set:
              tagIds: append(todo.tagIds, {tagId})
              updatedAt: now

      removeTag:
        params:
          tagId: string
        steps:
          - update: todos
            find: id equals params.id
            set:
              tagIds: remove(todo.tagIds, {tagId})
              updatedAt: now

      startEdit:
        steps:
          - set: { isEditing: true }
          - set:
              form.values.text: todo.text
              form.values.description: todo.description or ""

      cancelEdit:
        steps:
          - set: { isEditing: false }

      save:
        steps:
          - update: todos
            find: id equals params.id
            set:
              text: trim(form.values.text)
              description: trim(form.values.description)
              updatedAt: now

          - set: { isEditing: false }
          - toast: success("‰øùÂ≠ò„Åó„Åæ„Åó„Åü")

      delete:
        confirm:
          title: „Çø„Çπ„ÇØ„ÅÆÂâäÈô§
          message: „Åì„ÅÆ„Çø„Çπ„ÇØ„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü
          variant: danger
        steps:
          - delete: todos
            where: id equals params.id

          - navigate: TodoList
          - toast: success("ÂâäÈô§„Åó„Åæ„Åó„Åü")

  TagList:
    title: „Çø„Ç∞ÁÆ°ÁêÜ
    description: „Ç´„ÉÜ„Ç¥„É™„Åî„Å®„Å´„Çø„Ç∞„ÇíÁÆ°ÁêÜ„Åô„Çã

    route: /tags

    state:
      newLabelName:
        type: string
        initial: ""

      newAssigneeName:
        type: string
        initial: ""

      newPriorityName:
        type: string
        initial: ""

    computed:
      labelTags:
        filter: tags
        where: categoryId equals "label"

      assigneeTags:
        filter: tags
        where: categoryId equals "assignee"

      priorityTags:
        filter: tags
        where: categoryId equals "priority"

    layout:
      - AppLayout:
          children:
            - Card:
                padding: tokens.spacing.lg
                children:
                  - Text:
                      variant: h1
                      content: „Çø„Ç∞ÁÆ°ÁêÜ
                      align: center

                  - Spacer:
                      height: tokens.spacing.lg

                  - TagCategorySection:
                      category: tagCategories[0]
                      tags: labelTags
                      newTagName: newLabelName
                      on:add: actions.addLabel
                      on:delete: actions.deleteTag
                      on:click: navigate(TagDetail, { id: tag.id })
                      on:change:
                        set: { newLabelName: value }

                  - Spacer:
                      height: tokens.spacing.lg

                  - TagCategorySection:
                      category: tagCategories[1]
                      tags: assigneeTags
                      newTagName: newAssigneeName
                      on:add: actions.addAssignee
                      on:delete: actions.deleteTag
                      on:click: navigate(TagDetail, { id: tag.id })
                      on:change:
                        set: { newAssigneeName: value }

                  - Spacer:
                      height: tokens.spacing.lg

                  - TagCategorySection:
                      category: tagCategories[2]
                      tags: priorityTags
                      newTagName: newPriorityName
                      on:add: actions.addPriority
                      on:delete: actions.deleteTag
                      on:click: navigate(TagDetail, { id: tag.id })
                      on:change:
                        set: { newPriorityName: value }

    actions:
      addLabel:
        steps:
          - when: newLabelName is not empty
            do:
              - create: tags
                values:
                  id: uuid()
                  categoryId: "label"
                  name: trim(newLabelName)
              - set: { newLabelName: "" }

      addAssignee:
        steps:
          - when: newAssigneeName is not empty
            do:
              - create: tags
                values:
                  id: uuid()
                  categoryId: "assignee"
                  name: trim(newAssigneeName)
              - set: { newAssigneeName: "" }

      addPriority:
        steps:
          - when: newPriorityName is not empty
            do:
              - create: tags
                values:
                  id: uuid()
                  categoryId: "priority"
                  name: trim(newPriorityName)
              - set: { newPriorityName: "" }

      deleteTag:
        params:
          id: string
        confirm:
          title: „Çø„Ç∞„ÅÆÂâäÈô§
          message: „Åì„ÅÆ„Çø„Ç∞„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü‰ΩøÁî®‰∏≠„ÅÆ„Çø„Çπ„ÇØ„Åã„Çâ„ÇÇÂâäÈô§„Åï„Çå„Åæ„Åô„ÄÇ
          variant: danger
        steps:
          - delete: tags
            where: id equals {id}
          - each: todos
            where: tagIds contains {id}
            do:
              - update: todos
                find: id equals item.id
                set:
                  tagIds: remove(item.tagIds, {id})

  TagDetail:
    title: „Çø„Ç∞Ë©≥Á¥∞
    description: „Çø„Ç∞„ÅÆË©≥Á¥∞„Å®Èñ¢ÈÄ£„Çø„Çπ„ÇØ„ÇíË°®Á§∫

    route: /tags/:id

    params:
      id:
        type: string
        required: true

    state:
      isEditing:
        type: boolean
        initial: false

      editName:
        type: string
        initial: ""

    computed:
      tag:
        find: tags
        where: id equals params.id

      notFound:
        check: tag is null

      category:
        find: tagCategories
        where: id equals tag.categoryId

      relatedTodos:
        filter: todos
        where: tagIds contains params.id

      relatedCount:
        count: relatedTodos

    layout:
      - AppLayout:
          children:
            - Card:
                padding: tokens.spacing.lg
                children:
                  - Stack:
                      direction: horizontal
                      justify: space-between
                      align: center
                      children:
                        - IconButton:
                            icon: arrow_back
                            on:click: navigate(TagList)

                        - Text:
                            variant: h2
                            content: „Çø„Ç∞Ë©≥Á¥∞

                        - Box:
                            width: 40px

                  - Divider

                  - Spacer:
                      height: tokens.spacing.md

                  - when: notFound
                    show:
                      - Text:
                          content: „Çø„Ç∞„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì
                          color: tokens.colors.error
                          align: center

                      - Button:
                          label: „Çø„Ç∞‰∏ÄË¶ß„Å´Êàª„Çã
                          variant: outlined
                          fullWidth: true
                          on:click: navigate(TagList)

                  - when: not notFound
                    show:
                      - match: isEditing
                        cases:
                          false:
                            - Stack:
                                direction: vertical
                                gap: tokens.spacing.md
                                children:
                                  - Text:
                                      content: "„Ç´„ÉÜ„Ç¥„É™: {category.name}"
                                      variant: caption
                                      color: tokens.colors.text.secondary

                                  - Text:
                                      variant: h3
                                      content: "{category.icon} {tag.name}"

                                  - Divider

                                  - Text:
                                      content: "„Åì„ÅÆ„Çø„Ç∞„Åå‰ªò„ÅÑ„Åü„Çø„Çπ„ÇØ ({relatedCount}‰ª∂):"

                                  - each: relatedTodos
                                    as: todo
                                    key: todo.id
                                    render:
                                      - TodoItem:
                                          todo: todo
                                          on:click: navigate(TodoDetail, { id: todo.id })

                                  - Spacer:
                                      height: tokens.spacing.md

                                  - Stack:
                                      direction: horizontal
                                      gap: tokens.spacing.sm
                                      children:
                                        - Button:
                                            label: Á∑®ÈõÜ
                                            variant: primary
                                            flex: 1
                                            on:click: actions.startEdit

                                        - Button:
                                            label: ÂâäÈô§
                                            variant: outlined
                                            color: error
                                            on:click: actions.delete

                          true:
                            - Stack:
                                direction: vertical
                                gap: tokens.spacing.md
                                children:
                                  - TextField:
                                      label: „Çø„Ç∞Âêç
                                      value: editName
                                      on:change:
                                        set: { editName: value }

                                  - Stack:
                                      direction: horizontal
                                      gap: tokens.spacing.sm
                                      children:
                                        - Button:
                                            label: ‰øùÂ≠ò
                                            variant: primary
                                            flex: 1
                                            disabled: editName is empty
                                            on:click: actions.save

                                        - Button:
                                            label: „Ç≠„É£„É≥„Çª„É´
                                            variant: outlined
                                            on:click: actions.cancelEdit

    actions:
      startEdit:
        steps:
          - set:
              isEditing: true
              editName: tag.name

      cancelEdit:
        steps:
          - set: { isEditing: false }

      save:
        steps:
          - update: tags
            find: id equals params.id
            set:
              name: trim(editName)

          - set: { isEditing: false }
          - toast: success("‰øùÂ≠ò„Åó„Åæ„Åó„Åü")

      delete:
        confirm:
          title: „Çø„Ç∞„ÅÆÂâäÈô§
          message: „Åì„ÅÆ„Çø„Ç∞„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü‰ΩøÁî®‰∏≠„ÅÆ„Çø„Çπ„ÇØ„Åã„Çâ„ÇÇÂâäÈô§„Åï„Çå„Åæ„Åô„ÄÇ
          variant: danger
        steps:
          - delete: tags
            where: id equals params.id

          - each: todos
            where: tagIds contains params.id
            do:
              - update: todos
                find: id equals item.id
                set:
                  tagIds: remove(item.tagIds, params.id)

          - navigate: TagList
          - toast: success("ÂâäÈô§„Åó„Åæ„Åó„Åü")

components:
  AppLayout:
    description: ÂÖ±ÈÄö„É¨„Ç§„Ç¢„Ç¶„ÉàÔºà„Éò„ÉÉ„ÉÄ„Éº + „Éä„Éì + „Ç≥„É≥„ÉÜ„É≥„ÉÑÔºâ
    slots:
      default:
        required: true
    render:
      - Stack:
          direction: vertical
          height: 100vh
          children:
            - AppHeader:
                currentProject: currentProject
                projects: projects
                on:selectProject: actions.selectProject
                on:openProjectModal: actions.openProjectModal

            - AppNav

            - Box:
                flex: 1
                overflow: auto
                padding: tokens.spacing.lg
                children:
                  - Slot: default

  AppHeader:
    description: „Ç¢„Éó„É™„Éò„ÉÉ„ÉÄ„ÉºÔºà„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÈÅ∏ÊäûÔºâ
    props:
      currentProject:
        type: Project?
      projects:
        type: Project[]
    events:
      - selectProject
      - openProjectModal
    render:
      - Stack:
          direction: horizontal
          padding: tokens.spacing.md
          borderBottom: 1px solid tokens.colors.divider
          children:
            - ProjectSelector:
                currentProject: props.currentProject
                projects: props.projects
                on:select: emit(selectProject, value)
                on:manage: emit(openProjectModal)

  AppNav:
    description: „Ç¢„Éó„É™„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥
    render:
      - Stack:
          direction: horizontal
          gap: tokens.spacing.md
          padding: tokens.spacing.sm
          borderBottom: 1px solid tokens.colors.divider
          children:
            - NavLink:
                label: „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ
                to: /
            - NavLink:
                label: „Çø„Çπ„ÇØ
                to: /todos
            - NavLink:
                label: „Çø„Ç∞ÁÆ°ÁêÜ
                to: /tags

flows:
  MainFlow:
    initial: Dashboard

    transitions:
      - from: Dashboard
        to: TodoList
        on: viewAllTodos

      - from: Dashboard
        to: TodoDetail
        on: selectTodo
        params:
          id: todo.id

      - from: TodoList
        to: TodoDetail
        on: selectTodo
        params:
          id: todo.id

      - from: TodoDetail
        to: TodoList
        on: back

      - from: TodoDetail
        to: TagDetail
        on: selectTag
        params:
          id: tag.id

      - from: TagList
        to: TagDetail
        on: selectTag
        params:
          id: tag.id

      - from: TagDetail
        to: TagList
        on: back

      - from: TagDetail
        to: TodoDetail
        on: selectTodo
        params:
          id: todo.id

      - from: "*"
        to: Dashboard
        on: changeProject
